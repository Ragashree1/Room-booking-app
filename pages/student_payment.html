<!DOCTYPE html>
<html>
<head>
	<title>Payment Page</title>
	<style>
		body {
			font-family: Montserrat,Verdana,Geneva,sans-serif;
		}

		header {
			display: flex;
			align-items: center;
			justify-content: center;
			background-color: #333;
			color: #fff;
			padding: 10px;
		}

		form {
			display: flex;
			flex-direction: column;
			align-items: center;
			margin-top: 50px;
		}

		input[type="text"], input[type="tel"], input[type="number"] {
			margin: 10px 0;
			padding: 10px;
			border: 1px solid #ccc;
			border-radius: 5px;
			width: 300px;
			font-size: 16px;
		}

		input[type="submit"] {
			margin: 20px 0;
			padding: 10px 20px;
			background-color: #333;
			color: #fff;
			border: none;
			border-radius: 5px;
			font-size: 16px;
			cursor: pointer;
		}
		label, input[type="text"], input[type="tel"], input[type="checkbox"], button {
        display: block;
        margin: 10px auto;
        text-align: center;
      }
      label {
        font-weight: bold;
      }

		input[type="submit"]:hover {
			background-color: #444;
		}

		.error {
			color: red;
			font-size: 14px;
			margin: 5px 0;
		}
	</style>
</head>
<body>
	<header>
		<h1>Payment</h1>
	</header>
	<form action="#" method="POST">
		<div id="credit_card_fields">
			<label for="card_name">Cardholder's Name:</label>
			<input type="text" id="card_name" name="card_name" required pattern="^[A-Za-z\s]+" placeholder="Enter cardholder's name">
			<br>
			<label for="card_number">Card Number:</label>
			<input type="text" id="card_number" name="card_number" required pattern="[0-9]{16}" placeholder="Enter card number (16 digits)">
			<br>
			<label for="exp_date">Expiration Date (MM/YY):</label>
			<input type="text" id="exp_date" name="exp_date" pattern="(0[1-9]|1[0-2])\/[0-9]{2}" placeholder="Enter expiration date (MM/YY)">
			<br>
			<label for="cvv">CVV:</label>
        		<input type="text" id="cvv" name="cvv" placeholder="CVV(3 digits)" required pattern="\d{3}">
			<br>
		</div>
		<div id="mobile_fields" style="display:none">
			<label for="phone_number">Phone Number:</label>
			<input type="tel" id="phone_number" name="phone_number" pattern="[0-9]{8}" placeholder="Enter phone number (8 digits)">
			<br>
		</div>
		<label for="amount">Amount:</label>
		<input type="number" id="amount" name="amount" min="1" placeholder="Enter amount">
		<br>
		<input type="submit" value="Confirm Payment">
		<button type="button" onclick="confirmPayment()">Cancel</button>
	</form>

	<script>
		function togglePaymentFields() {
			let paymentType = document.getElementById("payment_type").value;
			let creditCardFields = document.getElementById("credit_card_fields");
			let mobileFields = document.getElementById("mobile_fields");
			if (paymentType == "credit_card") {
				creditCard.style.display = "block";
			mobileFields.style.display = "none";
		} else if (paymentType == "mobile") {
			creditCardFields.style.display = "none";
			mobileFields.style.display = "block";
		}
	}

	function resetForm() {
		document.getElementById("payment_form").reset();
	}

	function validateForm() {
		let paymentType = document.getElementById("payment_type").value;
		let amount = document.getElementById("amount").value;

		if (paymentType == "credit_card") {
			let cardNumber = document.getElementById("card_number").value;
			let expDate = document.getElementById("exp_date").value;
			let currentDate = new Date();
			let month = currentDate.getMonth() + 1;
			let year = currentDate.getFullYear().toString().substr(-2);

			if (cardNumber.length !== 16) {
				document.getElementById("card_number_error").innerHTML = "Please enter a valid card number (16 digits)";
				return false;
			} else if (!expDate.match(/(0[1-9]|1[0-2])\/[0-9]{2}/)) {
				document.getElementById("exp_date_error").innerHTML = "Please enter a valid expiration date (MM/YY)";
				return false;
			} else if (expDate.substr(0, 2) < month && expDate.substr(3) <= year) {
				document.getElementById("exp_date_error").innerHTML = "The card has expired";
				return false;
			}
		} else if (paymentType == "mobile") {
			let phoneNumber = document.getElementById("phone_number").value;
			if (phoneNumber.length !== 8) {
				document.getElementById("phone_number_error").innerHTML = "Please enter a valid phone number (8 digits)";
				return false;
			}
		}

		if (amount < 1) {
			document.getElementById("amount_error").innerHTML = "Please enter a valid amount";
			return false;
		}

		return true;
	}
	let lastPaymentType = "credit_card"; // initialize the last payment type to credit card

function displayFields() {
  let paymentType = document.getElementById("payment_type").value;
  let creditCardFields = document.getElementById("credit_card_fields");
  let mobileFields = document.getElementById("mobile_fields");
  if (paymentType == "credit_card") {
    creditCardFields.style.display = "block";
    mobileFields.style.display = "none";
    lastPaymentType = "credit_card"; // remember the last payment type
  } else if (paymentType == "mobile") {
    creditCardFields.style.display = "none";
    mobileFields.style.display = "block";
    lastPaymentType = "mobile"; // remember the last payment type
  } else {
    creditCardFields.style.display = "block";
    mobileFields.style.display = "none";
  }
}


// add an event listener to the payment type select element
document.getElementById("payment_type").addEventListener("change", function() {
  let paymentType = document.getElementById("payment_type").value;
  if (paymentType == "credit_card" && lastPaymentType == "mobile") {
    displayFields(); // switch back to credit card fields if switching from mobile
  } else {
    displayFields(); // otherwise display the selected fields
  }
});
  	document.getElementById("payment_form").addEventListener("submit", function(event) {
		if (!validateForm()) {
			event.preventDefault();
		}
	});

	function confirmPayment() {
    var type = document.querySelector('input[name="type"]:checked').value;
    var amount = document.getElementById("amount").value;
    var successful = false;

    if (type === "mobile") {
        var phone = document.getElementById("phone").value;
        if (phone.length === 8) {
            successful = true;
        }
    } else if (type === "credit") {
        var cardNumber = document.getElementById("card-number").value;
        var expiryMonth = document.getElementById("expiry-month").value;
        var expiryYear = document.getElementById("expiry-year").value;
        var cvv = document.getElementById("cvv").value;
        var today = new Date();
        var expiryDate = new Date(expiryYear, expiryMonth, 0);
        if (cardNumber.length === 16 && expiryDate > today && cvv.length === 3) {
            successful = true;
        }
    }

    if (successful) {
        window.location.href = "success.html";
    } else {
        alert("Payment details are incorrect. Please check and try again.");
    }
}

</script>

